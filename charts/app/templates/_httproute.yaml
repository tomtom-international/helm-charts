{{- define "common.httproute" -}}
---
apiVersion: gateway.networking.k8s.io/v1
kind: HTTPRoute
metadata: {{- include "common.metadata" . | nindent 2 }}
{{- $parentRefDefaults := dict "group" "gateway.networking.k8s.io" "kind" "Gateway" "namespace" "istio-ingress" "port" 443 "name" .name }}
{{ range $x := .parentRefs }}{{ $_ := mergeOverwrite $x $parentRefDefaults (deepCopy $x) }}{{ end }}
spec: {{- include "common.render-spec" . | nindent 2 }}
{{- end -}}
